## flush

- 영속성 컨텍스트의 변경내용을 DB에 반영하는 것

- 영속성 컨텍스트의 변경 사항과 db를 맞추는 작업

## 플러시 발생

- 변경 감지(dirty checking)

- 수정된 엔티티 쓰기 지연 SQL 저장소에 등록

- 쓰기 지연 SQL 저장소의 쿼리를 DB에 전송(등록 .. 등)

## 영속성 컨텍스트를 플러시 하는 방법

- em.flush() 직접 강제 호출

- tx.commit() : 자동으로 호출

- JPQL 쿼리 실행 : 자동으로 호출

  - 이전에 persist로 해둔건 아직 DB에 반영안된건데, JPQL 검색쿼리 등은 DB를 긁어 오는것이기 때문에

### flush 를 한다고 1차 캐시가 다 삭제되는 게 아니다.

- 오직 쓰기 지연 SQL 저장소의 SQL문이 DB에 전송되는 것

## 플러시는!

- 영속성 컨텍스트를 비우는게 아니다.

- 변경내용을 데이터베이스에 동기화 하는 것

- 트랜잭션이라는 작업 단위가 중요하다. -> 결국 커밋 직전에 동기화 하면 된다.
